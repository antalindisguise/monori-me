const CACHE_VERSION=1,BASE_CACHE_FILES=["/index.html","/blog/index.html","/about/index.html","/projects/index.html","/assets/images/profile.jpg","/assets/manifest.json","/assets/images/favicon/favicon.ico"],OFFLINE_CACHE_FILES=BASE_CACHE_FILES,NOT_FOUND_CACHE_FILES=BASE_CACHE_FILES,OFFLINE_PAGE="/index.html",NOT_FOUND_PAGE="/index.html",CACHE_VERSIONS={assets:"assets-v1",content:"content-v1",offline:"offline-v1",notFound:"404-v1"},MAX_TTL={"/":3600,html:3600,json:86400,js:86400,css:86400},CACHE_BLACKLIST=[],SUPPORTED_METHODS=["GET"];function isBlacklisted(e){return CACHE_BLACKLIST.length>0&&!CACHE_BLACKLIST.filter(t=>"function"==typeof t&&!t(e)).length}function getFileExtension(e){let t=e.split(".").reverse()[0].split("?")[0];return t.endsWith("/")?"/":t}function getTTL(e){if("string"==typeof e){let t=getFileExtension(e);return"number"==typeof MAX_TTL[t]?MAX_TTL[t]:null}return null}function installServiceWorker(){return Promise.all([caches.open(CACHE_VERSIONS.assets).then(e=>e.addAll(BASE_CACHE_FILES)),caches.open(CACHE_VERSIONS.offline).then(e=>e.addAll(OFFLINE_CACHE_FILES)),caches.open(CACHE_VERSIONS.notFound).then(e=>e.addAll(NOT_FOUND_CACHE_FILES))]).then(()=>self.skipWaiting())}function cleanupLegacyCache(){let e=Object.keys(CACHE_VERSIONS).map(e=>CACHE_VERSIONS[e]);return new Promise((t,n)=>{caches.keys().then(t=>legacyKeys=t.filter(t=>!~e.indexOf(t))).then(e=>{e.length?Promise.all(e.map(e=>caches.delete(e))).then(()=>{t()}).catch(e=>{n(e)}):t()}).catch(()=>{n()})})}function precacheUrl(e){isBlacklisted(e)||caches.open(CACHE_VERSIONS.content).then(t=>{t.match(e).then(t=>t?null:fetch(e)).then(n=>n?t.put(e,n.clone()):null)})}self.addEventListener("install",e=>{e.waitUntil(Promise.all([installServiceWorker(),self.skipWaiting()]))}),self.addEventListener("activate",e=>{e.waitUntil(Promise.all([cleanupLegacyCache(),self.clients.claim(),self.skipWaiting()]).catch(t=>{e.skipWaiting()}))}),self.addEventListener("fetch",e=>{e.respondWith(caches.open(CACHE_VERSIONS.content).then(t=>t.match(e.request).then(n=>{if(n){let s=n.headers.entries(),l=null;for(let e of s)"date"===e[0]&&(l=new Date(e[1]));if(l){let s=parseInt(((new Date).getTime()-l.getTime())/1e3),a=getTTL(e.request.url);return a&&s>a?new Promise(s=>fetch(e.request.clone()).then(l=>{l?(t.put(e.request,l.clone()),s(l)):s(n)}).catch(()=>{s(n)})).catch(e=>n):n}return n}return null}).then(n=>n||fetch(e.request.clone()).then(n=>n.status<400?(~SUPPORTED_METHODS.indexOf(e.request.method)&&!isBlacklisted(e.request.url)&&t.put(e.request,n.clone()),n):caches.open(CACHE_VERSIONS.notFound).then(e=>e.match("/index.html"))).then(e=>{if(e)return e}).catch(()=>caches.open(CACHE_VERSIONS.offline).then(e=>e.match(OFFLINE_PAGE)))).catch(e=>{throw console.error("  Error in fetch handler:",e),e})))}),self.addEventListener("message",e=>{if("object"==typeof e.data&&"string"==typeof e.data.action)switch(e.data.action){case"cache":precacheUrl(e.data.url);break;default:console.log("Unknown action: "+e.data.action)}});